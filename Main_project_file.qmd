---
title: "Main_project_file"
format: 
  pdf:
    fig-pos: "H"
editor: source
---

```{r}
library(tidyverse)
library(ggplot2)
```

## Importing data into R

```{r}
taylor_album_songs <- read_csv("/Users/donyabehroozi/Desktop/stat365/stat-365/data/taylor_album_songs.csv")
taylor_ratings <- read_csv("/Users/donyabehroozi/Desktop/stat365/stat-365/data/taylor_albums.csv")
```

## Merging data sets together

```{r}
taylor_albums_joined <- taylor_album_songs |>
  left_join(taylor_ratings, by = c("album_name", ep = "ep", album_release = "album_release"))

head(taylor_albums_joined)
```

# Linear regression analysis (danceability vs. user scores)

```{r}
taylor.fit1=lm(danceability~user_score, data = taylor_albums_joined)

taylor_albums_joined |>
  ggplot(aes(x = user_score, y = danceability)) +
  geom_point(size = 2, shape = 1) +
  geom_smooth(method = "lm") +
  labs(title = "Scatter Plot of Danceability vs. User Score", x = "User Score", y = " ", subtitle = "Danceability") +
  theme_light() +
  theme(plot.title = element_text(face = "bold")) +
  annotate(geom = "label",
           x = 8.75,
           y = 0.7,
           label = "Regression line") +
  annotate(geom = "segment",
           x = 8.75,
           y = 0.68,
           xend = 8.75,
           yend = 0.61,
           arrow = arrow(length = unit(0.15, "inches"))) +
  scale_y_continuous(breaks = c(0.2, 0.4, 0.6,  0.8, 1.0))

```

# Hypotheses

$H_0$: Audience rating is not linearly associated with danceability score.

$H_A$: Audience rating is linearly associated with danceability score.

# Checking simple linear regression assumptions

```{r}
par(mfrow=c(1,3))
plot(resid(taylor.fit1)~fitted(taylor.fit1), xlab='Fitted', ylab='Residuals');abline(h=0,lty=2)
qqnorm(resid(taylor.fit1),ylab='Residuals'); qqline(resid(taylor.fit1),lty=2)
hist(resid(taylor.fit1),main="", xlab="Residuals",col='lightblue')
```

# Results and conclusion

```{r}
summary(taylor.fit1)
```
Given the very small p-value (close to 0) we have strong evidence to reject the null hypothesis. Therefore, we have sufficient evidence to claim that audience rating is linearly associated with danceability score for this population.

# Linear regression analysis (danceability vs. metacritic scores)

```{r}
taylor.fit2=lm(danceability~metacritic_score, data = taylor_albums_joined)

```


# Hypotheses

$H_0$: Metacritic rating is not linearly associated with danceability score.

$H_A$: Metacritic rating is linearly associated with danceability score.

# Checking simple linear regression assumptions

```{r}
par(mfrow=c(1,3))
plot(resid(taylor.fit2)~fitted(taylor.fit2), xlab='Fitted', ylab='Residuals');abline(h=0,lty=2)
qqnorm(resid(taylor.fit2),ylab='Residuals'); qqline(resid(taylor.fit2),lty=2)
hist(resid(taylor.fit2),main="", xlab="Residuals",col='lightblue')
```

# Results and conclusion

```{r}
summary(taylor.fit2)
```

## Summary statistics table

```{r}
taylor_albums_joined |>
  arrange(album_release) |>
  group_by(album_name) |>
  summarise(mean_dance = mean(danceability), sd_dance = sd(danceability), mean_user = mean(user_score), mean_critic = mean(metacritic_score))
```

